{{ define "main" }}
  <h1>{{ .Title }}</h1>
  {{ with .Params.details }}
    <p>Details: <a href="{{ . }}">{{ . }}</a></p>
  {{ end }}
  {{ with .Params.description }}
    <p>Description: {{ . }}</p>
  {{ end }}
  {{ with or .Params.url .Params.details }}
    <hr>
  {{ end }}
  {{ .Content }}

  <p>Pages in "posts" where "category" contains one or more of "new york", "tokyo", or "london", and "unlisted" is not set to true.</p>

  {{ $p := where site.RegularPages "Type" "posts" }}
  {{ $p = where $p "Params.categories" "intersect" (slice "new york" "tokyo" "london") }}
  {{ $p = where $p "Params.unlisted" "ne" true }}

  {{ range $p }}
    <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
  {{ end }}

{{ end }}
