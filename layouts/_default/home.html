{{ define "main" }}
  <h1>{{ .Title }}</h1>
  {{ with .Params.details }}
    <p>Details: <a href="{{ . }}">{{ . }}</a></p>
  {{ end }}
  {{ with .Params.description }}
    <p>Description: {{ . }}</p>
  {{ end }}
  {{ with or .Params.url .Params.details }}
    <hr>
  {{ end }}
  {{ .Content }}

  {{ $s := slice }}
  {{ range site.RegularPages.ByTitle }}
    <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
    {{ if .HasShortcode "foo" }}
      {{ $s = $s | append (dict "path" .File.Path "ids" (.Store.Get "instances_of_foo") ) }}
    {{ end }}
  {{ end }}

  <hr>

  <p>Map of all instances of the foo shortcode in this page collection.</p>

  <pre>{{ jsonify (dict "indent" "  ") (sort $s "path") }}</pre>

{{ end }}
