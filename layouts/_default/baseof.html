<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0">
  <title>{{ if .IsHome }}{{ .Title }}{{ else }}{{ with .Title }}{{ printf "%s | " . }}{{ end }}{{ .Site.Title }}{{ end }}</title>

  {{- /* Get Sass resource. */}}
  {{- $scss := resources.Get "scss/main.scss" }}

  {{- /* Transpile to generate a short cache-busting target path. */}}
  {{- $css := $scss | toCSS }}
  {{- $cacheBuster := $css.Content | sha1 | first 7 }}
  {{- $targetPath := printf "css/main.%s.css" $cacheBuster }}

  {{- /* Transpile again with options. */}}
  {{- $options := dict "targetPath" $targetPath "transpiler" "libsass" }}
  {{- $css := $scss | toCSS $options | minify }}
  {{- $temp := $css | fingerprint "sha512" }}

  <link rel="stylesheet" href="{{ $css.RelPermalink }}" integrity="{{ $temp.Data.Integrity }}" crossorigin="anonymous">

  {{- /* Get JS resource. */}}
  {{ $jsResource := resources.Get "js/main.js"}}

  {{- /* Build to generate a short cache-busting target path. */}}
  {{- $js := $jsResource | js.Build }}
  {{- $cacheBuster := $js.Content | sha1 | first 7 }}
  {{- $targetPath := printf "js/main.%s.js" $cacheBuster }}

  {{- /* Build again with options. */}}
  {{- $options := dict "targetPath" $targetPath }}
  {{- $js := $jsResource | js.Build $options | minify }}
  {{- $temp := $js | fingerprint "sha512" }}

  <script src="{{ $js.RelPermalink }}" integrity="{{ $temp.Data.Integrity }}" crossorigin="anonymous"></script>

</head>
<body>
{{ block "main" . }}

{{ end }}
</body>
</html>
