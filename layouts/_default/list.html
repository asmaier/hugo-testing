{{ define "main" }}
  <h1>{{ .Title }}</h1>
  {{ .Content }}

  {{ $s := slice }}
  {{ range site.RegularPages.ByTitle }}
    <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
    {{ if .HasShortcode "foo" }}
      {{ $s = $s | append (dict "path" .File.Path "ids" (.Store.Get "instances_of_foo") ) }}
    {{ end }}
  {{ end }}

  <p>Map of all instances of the foo shortcode in this page collection.</p>

  <pre>{{ jsonify (dict "indent" "  ") (sort $s "path") }}</pre>

{{ end }}
